---
title: "School Data"
author: "Abby Zimmardi"
date: "10/23/2020"
output: html_document
---

```{r}
library(tidyverse)
#install.packages("rio") 
```

```{r}
#school <- rio::import('/Users/abbyzimmardi/Downloads/SchoolMaster.xlsx')
school <- rio::import('https://raw.githubusercontent.com/profrobwells/CovidFall2020/master/schools_master.csv')
school <- janitor::clean_names(school)
school$district <- tolower(school$name)
school$district <- gsub(" ", "_", school$district)
school$district <- gsub("southside_school_dist(independence)", "southside_school_dist_(independence)", school$district)
head(school)
```

```{r}
#schoolethnicity <- rio::import('/Users/abbyzimmardi/Downloads/Data Fall 2020/Data Story 2/Schools_Race_2020.xlsx')
schoolethnicity <- rio::import('https://raw.githubusercontent.com/profrobwells/CovidFall2020/master/School_Districts_FY31_Districts_EnrollmentByRace.csv')
schoolethnicity<- janitor::clean_names(schoolethnicity)
schoolethnicity$district <- tolower(schoolethnicity$district_description)
schoolethnicity$district <- gsub("district", "dist", schoolethnicity$district)
schoolethnicity$district <- gsub(" ", "_", schoolethnicity$district)
head(schoolethnicity)
```

#Join Tables
```{r}
glimpse(schoolethnicity)
```

```{r}
glimpse(school)
```
newtable <- inner_join(table1, table2, by=c("fieldname"="fieldname"))


#join tables
#need to fix the independence thing
```{r}
schools_combo <- school %>% 
  inner_join(schoolethnicity, by=c("district"))
```


#Math
```{r}
schools_combo <- schools_combo %>% 
  mutate(Pct_Hispanic = (hispanic_total/student_total)) %>% 
   mutate(Pct_White = (white_total/student_total)) %>% 
   mutate(Pct_Black = (black_total/student_total))

factcheck <- schools_combo %>% 
  select(district,  student_total, hispanic_total, Pct_Hispanic, white_total, Pct_White, black_total, Pct_Black)
```

#Covid per 1000 students
```{r}
schools_combo <- schools_combo %>% 
  mutate(Student_Covid_Per1000=(cumulative_student_cases/student_total)*1000) %>% 
  mutate(Active_Covid_Per1000=(active_cases/student_total)*1000)
#Active_Covid_Per1000 could be an issue if the active cases are both students and faculty

```

```{r}
write.csv(schools_combo, "schools_combo.csv")
```

#Fact Check Table
```{r}
xy <- schools_combo %>% 
  select(date, district, cumulative_student_cases, student_total, Student_Covid_Per1000) %>% 
```


```{r}
hispanic_covid <- schools_combo %>% 
  select(district, student_total, hispanic_total, Pct_Hispanic, Student_Covid_Per1000,Active_Covid_Per1000) %>% 
  filter(Pct_Hispanic > .20)
```
